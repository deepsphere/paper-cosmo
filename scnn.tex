%% 
%% Copyright 2007, 2008, 2009 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 
%% Template article for Elsevier's document class `elsarticle'
%% with harvard style bibliographic references
%% SP 2008/03/01

\documentclass[preprint,12pt,authoryear]{elsarticle}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times,authoryear]{elsarticle}
%% \documentclass[final,1p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,3p,times,authoryear]{elsarticle}
%% \documentclass[final,3p,times,twocolumn,authoryear]{elsarticle}
%% \documentclass[final,5p,times,authoryear]{elsarticle}
%% \documentclass[final,5p,times,twocolumn,authoryear]{elsarticle}


\usepackage[utf8]{inputenc}



%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{color}
\usepackage{url}
\usepackage{hyperref}
\usepackage{graphicx,array}
\usepackage{amsmath}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}

\newcommand{\nati}[1]{{\color[rgb]{.1,.6,.1}{#1}}}

\newcommand{\todo}[1]{{\color[rgb]{.6,.1,.6}{#1}}}

\newcommand{\assign}[1]{{\color[rgb]{.8,.5,.8}{Assigned: #1 }}}




\journal{Astronomy and Computing}

\begin{document}

\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%% \title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%% \author{Name\corref{cor1}\fnref{label2}}
%% \ead{email address}
%% \ead[url]{home page}
%% \fntext[label2]{}
%% \cortext[cor1]{}
%% \address{Address\fnref{label3}}
%% \fntext[label3]{}

\title{Efficient spherical Convolutional Neural Networks with Healpix sampling for cosmological applications}

%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \address[label1]{}
%% \address[label2]{}

\author{}

\address{}

\begin{abstract}
%% Text of abstract

	\todo{(MichaÃ«l) I would not invent a new term, SCNN, but rather say that convolutional neural networks on graphs (or GCNs) can be efficiently applied to (spherical?) cosmological applications.
	Arguments: the method is not new and hence don't deserve a new name. Emphasize that it is generic to the data structure, and that the sphere is simply a particular graph.
	Ideas: Graph Convolutional Networks for efficient spherical ???, Efficient spherical ??? with GCNs and Healpix sampling
}

\end{abstract}

\begin{keyword}
%% keywords here, in the form: keyword \sep keyword

%% PACS codes here, in the form: \PACS code \sep code

%% MSC codes here, in the form: \MSC code \sep code
%% or \MSC[2008] code \sep code (2000 is the default)

\end{keyword}

\end{frontmatter}

%% \linenumbers

%% main text
\section{Introduction}
\label{sec:intro}




\subsection{Motivation}
\assign{Tomek}

a) Cosmology has a lot of spherical data. Our solution is easy to use and is based on the widely used healpix sampling.
b) It is the most efficient spherical convolution

\subsection{Potential applications}
	\assign{Tomek, Nathanael, Michael}

\begin{itemize}

	\item Efficient compression de-compression of 360 videos\cite{su2017learning}
	\item Analysis of spherical cosmological data such as the cosmic microwave background \cite{...}, already done in\cite{he2018analysis}.
\end{itemize}

Note that those neural networks are not restricted to the sphere and can be applied to any problem where we have data on a graph, such as social, biological or infrastructure networks.

\subsection{Related work}
\assign{Nathanael, Michael}
\label{sec:related}
\cite{cohen2017convolutional} 
\cite{cohen2018spherical}
\cite{boomsma2017spherical}
\cite{defferrard2016convolutional}

\nati{+ add other graph CNN approaches \cite{...}}

Previous work: [Bruna] which needed the full eigendecomposition of the Laplacian, costing $O(n^3)$ operations.

Spatial definitions of graph convolutions, e.g. [Niepert] needs to define an orientation in order to match the edges with the filters. Most often the orientation is not given by the application, and one has to define it (for example by ordering by degree or any other measure, or by using a graph coloring). There is no good default good orientation on general graphs and the choice of an orientation is highly application dependent.

Related to this, convolutional neural networks have been defined on manifolds and have achieved impressive results on shapes [Bronstein]. They however too depend on an orientation, which a sphere do not possess.

\section{Spherical convolution on sphere using a graph}
\assign{Nathanael}

As presented in~\cite{cohen2018spherical}, the most mathematical approach to extend the convolution on a sphere is to use a spherical Fourier transform. The convolution is then simply defined as the product in the spectral domain. This approach requires one Fourier and one inverse Fourier transform per convolution which is, even with accelerated algorithms, rather expensive. For 2-dimensional images, an efficient convolution can be achieved when the convolution kernel is localized (for example a 5x5 pixel patch) by doing the computation directly in the signal domain. Unfortunately, this approach cannot be directly extended to the spherical case. Hence, the main idea of this contribution is to leverage graph signal processing~\cite{shuman2013emerging} to define a spherical convolution that can be computed directly in the signal domain. 

In this section, we follow classical constructions presented in~\cite{cohen2018spherical,...} and \nati{show} that the resulting spherical convolution is close to one corresponding to spherical approach.

\paragraph{Graph creation.}
As a hard constraint resulting from the cosmological applications, we are bound to use the HealPix sampling~\cite{gorski2005healpix} and we create a weighted undirected graph where each pixel is a node (vertex) that is connected to his $8$ or $7$ closest neighboors\footnote{For some pixels, the $8^{th}$ nearest neighbor is not well defined.}. Given the set of nearest neighbors, we define the weight matrix $W$ using the following scheme
\begin{equation}
W[i,j]=\begin{cases}
e^{-\frac{\|x_i-x_j\|_2^2}{\sigma^2}} & \text{if pixels $i$ and $j$ are connected, and}\\
0 & \text{otherwise.}\\
\end{cases}
\end{equation}
Here $x_i$ is a 3-dimensional vector encoding the coordinate of the pixels $i$ on the sphere and $\sigma$ is the mean of $\|x_i-x_j\|_2$ over all connected pixels $i$ and $j$. The degree of a node (or a pixel) is defined as $d_i = \sum_j W[i,j]$. The degree matrix $D$ is the diagonal matrix where $D_ii=d_i$.

\paragraph{Graph Fourier Transform and spherical harmonics.}
The graph normalized graph Laplacian defined as $L = I - D^{-1/2} W D^{-1/2}$ is a second order differential operator that can be used to define the graph Fourier basis. 
 
\begin{itemize}
	\item We build a graph using the healpix sampling
	\item Define Fourier transform and show that the harmonics are visually close to the spherical harmonics
	\item Define spherical convolution using the graph Fourier transform and show heat diffusion example
	\item Show the limits of the approach and explain why we cannot have a perfect spherical convolution with this technique
\end{itemize}

\section{Efficient spherical CNN}
\assign{Michael}


\begin{itemize}
	\item We need efficient convolution, hence the Chebysheff trick
	\item Define spherical CNN using graph CNN
\end{itemize}

\section{Experiments}
\assign{Nathanael, Tomek}

\begin{itemize}
	\item With the entire sphere / different PSD (The PSD features + linear SVM is equivalently good)
	\item Without the entire sphere / same PSD (1 sample: the histogram features + kernelized SVM is equivalently good)
	\item ??
\end{itemize}


\section*{Thanks}

%% The Appendices part is started with the command \appendix;
%% appendix sections are then done as normal sections
%% \appendix

%% \section{}
%% \label{}

%% If you have bibdatabase file and want bibtex to generate the
%% bibitems, please use
%%
\section*{Bibliography}
\bibliographystyle{elsarticle-harv} 
\bibliography{biblio}

\end{document}

\endinput
%%
%% End of file `elsarticle-template-harv.tex'.
